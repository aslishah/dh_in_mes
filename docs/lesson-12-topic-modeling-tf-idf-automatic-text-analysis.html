<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Lesson 12: Topic Modeling &amp; TF-IDF (automatic text analysis) | Digital Humanities in Middle Eastern Studies</title>
  <meta name="description" content="This is a collection of relevant materials for the class ‘57-525 S: Digital Humanities in Middle East Studies — Introduction to Algorithmic Analysis’ (WS2021), offered at the University of Hamburg (Afrika-Asien Institut) and taught by Maxim G. Romanov" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Lesson 12: Topic Modeling &amp; TF-IDF (automatic text analysis) | Digital Humanities in Middle Eastern Studies" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://maximromanov.github.io/dh_in_mes/" />
  
  <meta property="og:description" content="This is a collection of relevant materials for the class ‘57-525 S: Digital Humanities in Middle East Studies — Introduction to Algorithmic Analysis’ (WS2021), offered at the University of Hamburg (Afrika-Asien Institut) and taught by Maxim G. Romanov" />
  <meta name="github-repo" content="maximromanov/dh_in_mes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Lesson 12: Topic Modeling &amp; TF-IDF (automatic text analysis) | Digital Humanities in Middle Eastern Studies" />
  
  <meta name="twitter:description" content="This is a collection of relevant materials for the class ‘57-525 S: Digital Humanities in Middle East Studies — Introduction to Algorithmic Analysis’ (WS2021), offered at the University of Hamburg (Afrika-Asien Institut) and taught by Maxim G. Romanov" />
  

<meta name="author" content="Maxim G. Romanov" />


<meta name="date" content="2022-01-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="touch-icon.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="lesson-11-mapping-data-using-tagged-data.html"/>
<link rel="next" href="lesson-13-social-network-analysis.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DH Methods for Middle Eastern Studies: Toward A Handbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Syllabus</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-details"><i class="fa fa-check"></i>Course Details</a></li>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#aims-contents-and-method-of-the-course"><i class="fa fa-check"></i><b>0.1</b> Aims, contents and method of the course</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#course-evaluation"><i class="fa fa-check"></i><b>0.2</b> Course Evaluation</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#class-participation"><i class="fa fa-check"></i><b>0.3</b> Class Participation</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#homework"><i class="fa fa-check"></i><b>0.4</b> Homework</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#final-project"><i class="fa fa-check"></i><b>0.5</b> Final Project</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#study-materials"><i class="fa fa-check"></i><b>0.6</b> Study materials:</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#software-tools-technologies"><i class="fa fa-check"></i><b>0.7</b> Software, Tools, &amp; Technologies:</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#submitting-homework"><i class="fa fa-check"></i><b>0.8</b> Submitting Homework:</a></li>
<li class="chapter" data-level="0.9" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>0.9</b> Schedule</a></li>
<li class="chapter" data-level="0.10" data-path="index.html"><a href="index.html#lesson-topics-subject-to-modification"><i class="fa fa-check"></i><b>0.10</b> Lesson Topics (subject to modification)</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="lesson-01-academic-writing-i.html"><a href="lesson-01-academic-writing-i.html"><i class="fa fa-check"></i><b>1</b> Lesson 01: Academic Writing I</a>
<ul>
<li class="chapter" data-level="1.1" data-path="lesson-01-academic-writing-i.html"><a href="lesson-01-academic-writing-i.html#bibliography-managers"><i class="fa fa-check"></i><b>1.1</b> Bibliography Managers</a></li>
<li class="chapter" data-level="1.2" data-path="lesson-01-academic-writing-i.html"><a href="lesson-01-academic-writing-i.html#zotero"><i class="fa fa-check"></i><b>1.2</b> Zotero</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="lesson-01-academic-writing-i.html"><a href="lesson-01-academic-writing-i.html#getting-started"><i class="fa fa-check"></i><b>1.2.1</b> Getting Started</a></li>
<li class="chapter" data-level="1.2.2" data-path="lesson-01-academic-writing-i.html"><a href="lesson-01-academic-writing-i.html#main-functionality"><i class="fa fa-check"></i><b>1.2.2</b> Main Functionality</a></li>
<li class="chapter" data-level="1.2.3" data-path="lesson-01-academic-writing-i.html"><a href="lesson-01-academic-writing-i.html#additional-functionality-plug-ins"><i class="fa fa-check"></i><b>1.2.3</b> Additional Functionality: Plug-Ins</a></li>
<li class="chapter" data-level="1.2.4" data-path="lesson-01-academic-writing-i.html"><a href="lesson-01-academic-writing-i.html#zotfile"><i class="fa fa-check"></i><b>1.2.4</b> Zotfile</a></li>
<li class="chapter" data-level="1.2.5" data-path="lesson-01-academic-writing-i.html"><a href="lesson-01-academic-writing-i.html#better-bibtex-for-zotero"><i class="fa fa-check"></i><b>1.2.5</b> Better BibTeX for Zotero</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lesson-01-academic-writing-i.html"><a href="lesson-01-academic-writing-i.html#HWL01"><i class="fa fa-check"></i><b>1.3</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lesson-02-command-line.html"><a href="lesson-02-command-line.html"><i class="fa fa-check"></i><b>2</b> Lesson 02: Command Line</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lesson-02-command-line.html"><a href="lesson-02-command-line.html#command-line"><i class="fa fa-check"></i><b>2.1</b> Command Line</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lesson-02-command-line.html"><a href="lesson-02-command-line.html#the-filesystem"><i class="fa fa-check"></i><b>2.1.1</b> The filesystem</a></li>
<li class="chapter" data-level="2.1.2" data-path="lesson-02-command-line.html"><a href="lesson-02-command-line.html#getting-started-with-the-command-line"><i class="fa fa-check"></i><b>2.1.2</b> Getting started with the command line</a></li>
<li class="chapter" data-level="2.1.3" data-path="lesson-02-command-line.html"><a href="lesson-02-command-line.html#components-of-the-command-line"><i class="fa fa-check"></i><b>2.1.3</b> Components of the command line</a></li>
<li class="chapter" data-level="2.1.4" data-path="lesson-02-command-line.html"><a href="lesson-02-command-line.html#file-paths-and-path-notations"><i class="fa fa-check"></i><b>2.1.4</b> File paths and path notations</a></li>
<li class="chapter" data-level="2.1.5" data-path="lesson-02-command-line.html"><a href="lesson-02-command-line.html#command-line-arguments"><i class="fa fa-check"></i><b>2.1.5</b> Command line arguments</a></li>
<li class="chapter" data-level="2.1.6" data-path="lesson-02-command-line.html"><a href="lesson-02-command-line.html#more-commands"><i class="fa fa-check"></i><b>2.1.6</b> More commands</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lesson-02-command-line.html"><a href="lesson-02-command-line.html#HWL02"><i class="fa fa-check"></i><b>2.2</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lesson-03-version-control.html"><a href="lesson-03-version-control.html"><i class="fa fa-check"></i><b>3</b> Lesson 03: Version Control</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lesson-03-version-control.html"><a href="lesson-03-version-control.html#version-control-and-collaboration"><i class="fa fa-check"></i><b>3.1</b> Version Control and Collaboration</a></li>
<li class="chapter" data-level="3.2" data-path="lesson-03-version-control.html"><a href="lesson-03-version-control.html#setting-up-git"><i class="fa fa-check"></i><b>3.2</b> Setting-up <code>git</code></a></li>
<li class="chapter" data-level="3.3" data-path="lesson-03-version-control.html"><a href="lesson-03-version-control.html#general-git-workflow"><i class="fa fa-check"></i><b>3.3</b> General <code>git</code> workflow</a></li>
<li class="chapter" data-level="3.4" data-path="lesson-03-version-control.html"><a href="lesson-03-version-control.html#main-git-commands"><i class="fa fa-check"></i><b>3.4</b> Main <code>git</code> Commands</a></li>
<li class="chapter" data-level="3.5" data-path="lesson-03-version-control.html"><a href="lesson-03-version-control.html#some-useful-command-line-commands-to-remember"><i class="fa fa-check"></i><b>3.5</b> Some useful command line commands to remember</a></li>
<li class="chapter" data-level="3.6" data-path="lesson-03-version-control.html"><a href="lesson-03-version-control.html#practice"><i class="fa fa-check"></i><b>3.6</b> Practice</a></li>
<li class="chapter" data-level="3.7" data-path="lesson-03-version-control.html"><a href="lesson-03-version-control.html#HWL03"><i class="fa fa-check"></i><b>3.7</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lesson-04-sustainable-academic-writing.html"><a href="lesson-04-sustainable-academic-writing.html"><i class="fa fa-check"></i><b>4</b> Lesson 04: Sustainable Academic Writing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lesson-04-sustainable-academic-writing.html"><a href="lesson-04-sustainable-academic-writing.html#markdown-pandoc-the-tex-family-and-obsidian"><i class="fa fa-check"></i><b>4.1</b> <code>markdown</code>, <code>pandoc</code>, the <code>*TeX</code> family, and <code>obsidian</code></a></li>
<li class="chapter" data-level="4.2" data-path="lesson-04-sustainable-academic-writing.html"><a href="lesson-04-sustainable-academic-writing.html#class-notes"><i class="fa fa-check"></i><b>4.2</b> Class Notes</a></li>
<li class="chapter" data-level="4.3" data-path="lesson-04-sustainable-academic-writing.html"><a href="lesson-04-sustainable-academic-writing.html#pandoc-commands"><i class="fa fa-check"></i><b>4.3</b> <code>pandoc</code> <em>Commands</em></a></li>
<li class="chapter" data-level="4.4" data-path="lesson-04-sustainable-academic-writing.html"><a href="lesson-04-sustainable-academic-writing.html#analytical-writing-with-markdown"><i class="fa fa-check"></i><b>4.4</b> Analytical Writing with markdown</a></li>
<li class="chapter" data-level="4.5" data-path="lesson-04-sustainable-academic-writing.html"><a href="lesson-04-sustainable-academic-writing.html#zettelkasten-with-obsidian"><i class="fa fa-check"></i><b>4.5</b> Zettelkasten with Obsidian</a></li>
<li class="chapter" data-level="4.6" data-path="lesson-04-sustainable-academic-writing.html"><a href="lesson-04-sustainable-academic-writing.html#reference-materials"><i class="fa fa-check"></i><b>4.6</b> Reference Materials:</a></li>
<li class="chapter" data-level="4.7" data-path="lesson-04-sustainable-academic-writing.html"><a href="lesson-04-sustainable-academic-writing.html#HWL04"><i class="fa fa-check"></i><b>4.7</b> Homework</a></li>
<li class="chapter" data-level="4.8" data-path="lesson-04-sustainable-academic-writing.html"><a href="lesson-04-sustainable-academic-writing.html#appendix-text-for-your-main.md-file."><i class="fa fa-check"></i><b>4.8</b> Appendix: <em>TEXT for your <code>main.md</code> file.</em></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html"><i class="fa fa-check"></i><b>5</b> Lesson 05: Robust Searches</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#constructing-robust-searches-with-regular-expressions"><i class="fa fa-check"></i><b>5.1</b> Constructing Robust Searches with Regular Expressions</a></li>
<li class="chapter" data-level="5.2" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#regular-expressions"><i class="fa fa-check"></i><b>5.2</b> <code>regular expressions</code></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#what-are-regular-expressions"><i class="fa fa-check"></i><b>5.2.1</b> What are <code>regular expressions</code>?**</a></li>
<li class="chapter" data-level="5.2.2" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#what-would-we-use-regular-expressions-for"><i class="fa fa-check"></i><b>5.2.2</b> What would we use <code>regular Expressions</code> for?</a></li>
<li class="chapter" data-level="5.2.3" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#the-basics"><i class="fa fa-check"></i><b>5.2.3</b> The Basics</a></li>
<li class="chapter" data-level="5.2.4" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#characters-special-characters"><i class="fa fa-check"></i><b>5.2.4</b> Characters <em>&amp;</em> Special Characters</a></li>
<li class="chapter" data-level="5.2.5" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#character-classes"><i class="fa fa-check"></i><b>5.2.5</b> Character Classes: <code>[]</code></a></li>
<li class="chapter" data-level="5.2.6" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#ranges-within-classes"><i class="fa fa-check"></i><b>5.2.6</b> Ranges (within classes)</a></li>
<li class="chapter" data-level="5.2.7" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#repeaters"><i class="fa fa-check"></i><b>5.2.7</b> Repeaters</a></li>
<li class="chapter" data-level="5.2.8" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#lab-intro-in-the-practicum-file."><i class="fa fa-check"></i><b>5.2.8</b> Lab: <em>Intro</em> (in the <em>practicum file</em>).</a></li>
<li class="chapter" data-level="5.2.9" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#anchoring"><i class="fa fa-check"></i><b>5.2.9</b> Anchoring</a></li>
<li class="chapter" data-level="5.2.10" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#alternation-pipe"><i class="fa fa-check"></i><b>5.2.10</b> Alternation: “|” (<em>pipe</em>)</a></li>
<li class="chapter" data-level="5.2.11" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#grouping"><i class="fa fa-check"></i><b>5.2.11</b> Grouping</a></li>
<li class="chapter" data-level="5.2.12" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#lab-part-i-in-the-practicum-file."><i class="fa fa-check"></i><b>5.2.12</b> Lab: Part I (in the <em>practicum file</em>).</a></li>
<li class="chapter" data-level="5.2.13" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#replacement"><i class="fa fa-check"></i><b>5.2.13</b> Replacement</a></li>
<li class="chapter" data-level="5.2.14" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#capture"><i class="fa fa-check"></i><b>5.2.14</b> Capture</a></li>
<li class="chapter" data-level="5.2.15" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#capture-reformat"><i class="fa fa-check"></i><b>5.2.15</b> Capture <em>&amp;</em> Reformat</a></li>
<li class="chapter" data-level="5.2.16" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#lab-part-ii-in-the-practicum-file."><i class="fa fa-check"></i><b>5.2.16</b> Lab: Part II (in the <em>practicum file</em>).</a></li>
<li class="chapter" data-level="5.2.17" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#to-keep-in-mind"><i class="fa fa-check"></i><b>5.2.17</b> <em>To keep in mind</em></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#class-materials"><i class="fa fa-check"></i><b>5.3</b> Class materials</a></li>
<li class="chapter" data-level="5.4" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#digital-materials"><i class="fa fa-check"></i><b>5.4</b> Digital materials</a></li>
<li class="chapter" data-level="5.5" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#reference-materials-1"><i class="fa fa-check"></i><b>5.5</b> Reference Materials</a></li>
<li class="chapter" data-level="5.6" data-path="lesson-05-robust-searches.html"><a href="lesson-05-robust-searches.html#HWL05"><i class="fa fa-check"></i><b>5.6</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html"><i class="fa fa-check"></i><b>6</b> Lesson 06: Webscraping</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#getting-to-know-wget"><i class="fa fa-check"></i><b>6.1</b> Getting to Know <code>WGET</code></a></li>
<li class="chapter" data-level="6.2" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#software"><i class="fa fa-check"></i><b>6.2</b> Software</a></li>
<li class="chapter" data-level="6.3" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#class"><i class="fa fa-check"></i><b>6.3</b> Class</a></li>
<li class="chapter" data-level="6.4" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#sample-commands"><i class="fa fa-check"></i><b>6.4</b> Sample commands</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#issues-with-wget-on-windows"><i class="fa fa-check"></i><b>6.4.1</b> Issues with <code>WGET</code> on Windows</a></li>
<li class="chapter" data-level="6.4.2" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#issues-with-wget-on-mac"><i class="fa fa-check"></i><b>6.4.2</b> Issues with <code>WGET</code> on Mac</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#a-sidenote-on-issues-in-general"><i class="fa fa-check"></i><b>6.5</b> A sidenote on issues in general</a></li>
<li class="chapter" data-level="6.6" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#practicing-scraping"><i class="fa fa-check"></i><b>6.6</b> Practicing Scraping</a></li>
<li class="chapter" data-level="6.7" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#practice-1-very-easy"><i class="fa fa-check"></i><b>6.7</b> Practice 1: very easy</a></li>
<li class="chapter" data-level="6.8" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#practice-2-easy-ish"><i class="fa fa-check"></i><b>6.8</b> Practice 2: easy-ish</a></li>
<li class="chapter" data-level="6.9" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#practice-3-aka-homework-a-tiny-bit-tricky"><i class="fa fa-check"></i><b>6.9</b> Practice 3 (aka <em>Homework</em>): a tiny-bit tricky</a></li>
<li class="chapter" data-level="6.10" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#RML06"><i class="fa fa-check"></i><b>6.10</b> Reference Materials</a></li>
<li class="chapter" data-level="6.11" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#HWL06"><i class="fa fa-check"></i><b>6.11</b> Homework</a></li>
<li class="chapter" data-level="6.12" data-path="lesson-06-webscraping.html"><a href="lesson-06-webscraping.html#SHL06"><i class="fa fa-check"></i><b>6.12</b> Submitting homework</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html"><i class="fa fa-check"></i><b>7</b> Lesson 07: Understanding Structured Data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#major-data-formats"><i class="fa fa-check"></i><b>7.1</b> Major Data Formats</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#xml-extensible-markup-language"><i class="fa fa-check"></i><b>7.1.1</b> XML (<em>Extensible Markup Language</em>)</a></li>
<li class="chapter" data-level="7.1.2" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#csvtsv-comma-separated-values-tab-separated-values"><i class="fa fa-check"></i><b>7.1.2</b> CSV/TSV (<em>Comma-Separated Values</em>/ <em>Tab-Separated Values</em>)</a></li>
<li class="chapter" data-level="7.1.3" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#json-javascript-object-notation"><i class="fa fa-check"></i><b>7.1.3</b> JSON (<em>JavaScript Object Notation</em>)</a></li>
<li class="chapter" data-level="7.1.4" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#yml-or-yaml-yet-another-markup-language-yaml-aint-markup-language"><i class="fa fa-check"></i><b>7.1.4</b> YML or YAML (<em>Yet Another Markup Language</em> &gt; <em>YAML Ain’t Markup Language</em>)</a></li>
<li class="chapter" data-level="7.1.5" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#bibtex-most-common-bibliographic-format"><i class="fa fa-check"></i><b>7.1.5</b> <code>BibTeX</code>: <em>most common bibliographic format</em></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#larger-examples"><i class="fa fa-check"></i><b>7.2</b> Larger Examples</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#csv-tsv"><i class="fa fa-check"></i><b>7.2.1</b> <code>CSV</code> / <code>TSV</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#json"><i class="fa fa-check"></i><b>7.2.2</b> <code>JSON</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#ymlyaml"><i class="fa fa-check"></i><b>7.2.3</b> <code>YML</code>/<code>YAML</code></a></li>
<li class="chapter" data-level="7.2.4" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#installing-libraries-for-python"><i class="fa fa-check"></i><b>7.2.4</b> Installing libraries for <code>python</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#in-class-practice-and-homework"><i class="fa fa-check"></i><b>7.3</b> In-Class Practice (and homework)</a></li>
<li class="chapter" data-level="7.4" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#HWL07"><i class="fa fa-check"></i><b>7.4</b> Homework</a></li>
<li class="chapter" data-level="7.5" data-path="lesson-07-understanding-structured-data.html"><a href="lesson-07-understanding-structured-data.html#SolutionL07"><i class="fa fa-check"></i><b>7.5</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lesson-08-converting-the-dispatch.html"><a href="lesson-08-converting-the-dispatch.html"><i class="fa fa-check"></i><b>8</b> Lesson 08: Converting the Dispatch</a>
<ul>
<li class="chapter" data-level="8.1" data-path="lesson-08-converting-the-dispatch.html"><a href="lesson-08-converting-the-dispatch.html#original-xml-files-analysis"><i class="fa fa-check"></i><b>8.1</b> Original XML files analysis</a></li>
<li class="chapter" data-level="8.2" data-path="lesson-08-converting-the-dispatch.html"><a href="lesson-08-converting-the-dispatch.html#convert-to-a-cleaner-format"><i class="fa fa-check"></i><b>8.2</b> Convert to a cleaner format</a></li>
<li class="chapter" data-level="8.3" data-path="lesson-08-converting-the-dispatch.html"><a href="lesson-08-converting-the-dispatch.html#in-class-practice-and-homework-1"><i class="fa fa-check"></i><b>8.3</b> In-Class Practice (and homework)</a></li>
<li class="chapter" data-level="8.4" data-path="lesson-08-converting-the-dispatch.html"><a href="lesson-08-converting-the-dispatch.html#HWL08"><i class="fa fa-check"></i><b>8.4</b> Homework</a></li>
<li class="chapter" data-level="8.5" data-path="lesson-08-converting-the-dispatch.html"><a href="lesson-08-converting-the-dispatch.html#SolutionL08"><i class="fa fa-check"></i><b>8.5</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="lesson-09-extracting-tagged-data-for-analysis.html"><a href="lesson-09-extracting-tagged-data-for-analysis.html"><i class="fa fa-check"></i><b>9</b> Lesson 09: Extracting Tagged Data for Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="lesson-09-extracting-tagged-data-for-analysis.html"><a href="lesson-09-extracting-tagged-data-for-analysis.html#concept-of-tidy-data"><i class="fa fa-check"></i><b>9.1</b> Concept of <em>tidy data</em></a></li>
<li class="chapter" data-level="9.2" data-path="lesson-09-extracting-tagged-data-for-analysis.html"><a href="lesson-09-extracting-tagged-data-for-analysis.html#extracting-tagged-entities"><i class="fa fa-check"></i><b>9.2</b> Extracting tagged entities</a></li>
<li class="chapter" data-level="9.3" data-path="lesson-09-extracting-tagged-data-for-analysis.html"><a href="lesson-09-extracting-tagged-data-for-analysis.html#HWL09"><i class="fa fa-check"></i><b>9.3</b> Homework</a></li>
<li class="chapter" data-level="9.4" data-path="lesson-09-extracting-tagged-data-for-analysis.html"><a href="lesson-09-extracting-tagged-data-for-analysis.html#SolutionL09"><i class="fa fa-check"></i><b>9.4</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lesson-10-graphing-chronological-distribution-of-tagged-entities.html"><a href="lesson-10-graphing-chronological-distribution-of-tagged-entities.html"><i class="fa fa-check"></i><b>10</b> Lesson 10: Graphing Chronological Distribution of Tagged Entities</a>
<ul>
<li class="chapter" data-level="10.1" data-path="lesson-10-graphing-chronological-distribution-of-tagged-entities.html"><a href="lesson-10-graphing-chronological-distribution-of-tagged-entities.html#abstractions-of-newspaper-articles"><i class="fa fa-check"></i><b>10.1</b> Abstractions of Newspaper Articles</a></li>
<li class="chapter" data-level="10.2" data-path="lesson-10-graphing-chronological-distribution-of-tagged-entities.html"><a href="lesson-10-graphing-chronological-distribution-of-tagged-entities.html#code-line-graph"><i class="fa fa-check"></i><b>10.2</b> Code: Line Graph</a></li>
<li class="chapter" data-level="10.3" data-path="lesson-10-graphing-chronological-distribution-of-tagged-entities.html"><a href="lesson-10-graphing-chronological-distribution-of-tagged-entities.html#missing-zeros-problem"><i class="fa fa-check"></i><b>10.3</b> Missing Zeros Problem</a></li>
<li class="chapter" data-level="10.4" data-path="lesson-10-graphing-chronological-distribution-of-tagged-entities.html"><a href="lesson-10-graphing-chronological-distribution-of-tagged-entities.html#code-lollipop-graph"><i class="fa fa-check"></i><b>10.4</b> Code: Lollipop Graph</a></li>
<li class="chapter" data-level="10.5" data-path="lesson-10-graphing-chronological-distribution-of-tagged-entities.html"><a href="lesson-10-graphing-chronological-distribution-of-tagged-entities.html#jupyter-notebook"><i class="fa fa-check"></i><b>10.5</b> Jupyter Notebook</a></li>
<li class="chapter" data-level="10.6" data-path="lesson-10-graphing-chronological-distribution-of-tagged-entities.html"><a href="lesson-10-graphing-chronological-distribution-of-tagged-entities.html#HWL10"><i class="fa fa-check"></i><b>10.6</b> Homework</a></li>
<li class="chapter" data-level="10.7" data-path="lesson-10-graphing-chronological-distribution-of-tagged-entities.html"><a href="lesson-10-graphing-chronological-distribution-of-tagged-entities.html#SolutionL10"><i class="fa fa-check"></i><b>10.7</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lesson-11-mapping-data-using-tagged-data.html"><a href="lesson-11-mapping-data-using-tagged-data.html"><i class="fa fa-check"></i><b>11</b> Lesson 11: Mapping Data (using tagged data)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lesson-11-mapping-data-using-tagged-data.html"><a href="lesson-11-mapping-data-using-tagged-data.html#preparing-and-modeling-geospatial-data"><i class="fa fa-check"></i><b>11.1</b> Preparing and Modeling Geospatial Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="lesson-11-mapping-data-using-tagged-data.html"><a href="lesson-11-mapping-data-using-tagged-data.html#triples-n-triples"><i class="fa fa-check"></i><b>11.1.1</b> Triples (<code>N-triples</code>)</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="lesson-11-mapping-data-using-tagged-data.html"><a href="lesson-11-mapping-data-using-tagged-data.html#HWL11"><i class="fa fa-check"></i><b>11.2</b> Homework</a></li>
<li class="chapter" data-level="11.3" data-path="lesson-11-mapping-data-using-tagged-data.html"><a href="lesson-11-mapping-data-using-tagged-data.html#SolutionL11"><i class="fa fa-check"></i><b>11.3</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><i class="fa fa-check"></i><b>12</b> Lesson 12: Topic Modeling <em>&amp;</em> TF-IDF (automatic text analysis)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#goals"><i class="fa fa-check"></i><b>12.1</b> Goals:</a></li>
<li class="chapter" data-level="12.2" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#software-1"><i class="fa fa-check"></i><b>12.2</b> Software</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#installing-on-windows"><i class="fa fa-check"></i><b>12.2.1</b> Installing: on Windows</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#thinking-about-themes-and-topics"><i class="fa fa-check"></i><b>12.3</b> Thinking about themes and topics</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#first-set-of-examples"><i class="fa fa-check"></i><b>12.3.1</b> First set of Examples</a></li>
<li class="chapter" data-level="12.3.2" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#second-set-of-examples"><i class="fa fa-check"></i><b>12.3.2</b> Second Set of Examples</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#implementation"><i class="fa fa-check"></i><b>12.4</b> Implementation</a></li>
<li class="chapter" data-level="12.5" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#tf-idf"><i class="fa fa-check"></i><b>12.5</b> TF-IDF</a></li>
<li class="chapter" data-level="12.6" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#implementation-in-jupyter-notebook"><i class="fa fa-check"></i><b>12.6</b> Implementation in Jupyter Notebook</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#jupyter-notebook-1"><i class="fa fa-check"></i><b>12.6.1</b> jupyter notebook</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#files-scripts"><i class="fa fa-check"></i><b>12.7</b> Files &amp; Scripts</a></li>
<li class="chapter" data-level="12.8" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#HWL12"><i class="fa fa-check"></i><b>12.8</b> Homework</a></li>
<li class="chapter" data-level="12.9" data-path="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#SolutionL12"><i class="fa fa-check"></i><b>12.9</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="lesson-13-social-network-analysis.html"><a href="lesson-13-social-network-analysis.html"><i class="fa fa-check"></i><b>13</b> Lesson 13: Social Network Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="lesson-13-social-network-analysis.html"><a href="lesson-13-social-network-analysis.html#section"><i class="fa fa-check"></i><b>13.1</b> …</a></li>
<li class="chapter" data-level="13.2" data-path="lesson-13-social-network-analysis.html"><a href="lesson-13-social-network-analysis.html#HWL13"><i class="fa fa-check"></i><b>13.2</b> Homework</a></li>
<li class="chapter" data-level="13.3" data-path="lesson-13-social-network-analysis.html"><a href="lesson-13-social-network-analysis.html#SolutionL13"><i class="fa fa-check"></i><b>13.3</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Digital Humanities in Middle Eastern Studies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lesson-12-topic-modeling-tf-idf-automatic-text-analysis" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Lesson 12: Topic Modeling <em>&amp;</em> TF-IDF (automatic text analysis)</h1>
<div id="goals" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Goals:</h2>
<ul>
<li>Introduction to topic modeling, or how to classify texts by shared content (“topics”).</li>
</ul>
</div>
<div id="software-1" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Software</h2>
<ul>
<li>python</li>
<li>other python libraries
<ul>
<li><code>wheel</code> (this package is helpful for the installation of <code>gensim</code> and <code>pyLDAvis</code>)</li>
<li><code>nltk</code></li>
<li><code>gensim</code></li>
<li><code>spacy</code></li>
<li><code>pyLDAvis</code></li>
<li><code>matplotlib</code></li>
<li><code>numpy</code></li>
<li><code>pandas</code></li>
<li><code>plotly</code></li>
<li><code>pprint</code></li>
</ul></li>
<li><em>alternatively</em>: jupyter notebook (see the last part of the Lesson)</li>
</ul>
<!--
## Workbooks (jupyter notebooks)

- [for Windows](https://www.dropbox.com/s/b1jg5r3bmgforu5/TnT_L12_materials_final_Win.zip?dl=0)
- [for Mac and Linux](https://www.dropbox.com/s/zey9qtuht1tnsku/TnT_L12_materials_final.zip?dl=0)
-->
<div id="installing-on-windows" class="section level3" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Installing: on Windows</h3>
<p>On Mac and Linux things are easy, just follow the commands below; for Windows things are trickier and the easiest way would be to use Anaconda <a href="https://www.anaconda.com/distribution/#download-section" class="uri">https://www.anaconda.com/distribution/#download-section</a>.</p>
<p>Please, download and install. Most packages will come with Anaconda distribution; others you can install through its interface.</p>
<p><strong>NB:</strong> After Anaconda is installed, it is still better to install libraries from the terminal opened directly from Anaconda and using the following command <code>conda install -c conda-forge gensim</code> (the latest version is not available via Anaconda interface).
More details: <a href="https://radimrehurek.com/gensim/install.html" class="uri">https://radimrehurek.com/gensim/install.html</a></p>
<div id="installing-on-mac-and-linux" class="section level4" number="12.2.1.1">
<h4><span class="header-section-number">12.2.1.1</span> Installing: on Mac and Linux</h4>
<p>Python libraries and additional data can be installed in the following manner</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install nameOfLibrary</span></code></pre></div>
<p>Although a better way would be (where <code>python3</code> is the exact version of <code>python</code> that you are using):</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> pip install nameOfLibrary</span></code></pre></div>
<p>Lemmatization library (although we are not going to be using it in the tutorial)</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> spacy download en</span></code></pre></div>
</div>
</div>
</div>
<div id="thinking-about-themes-and-topics" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Thinking about themes and topics</h2>
<div id="first-set-of-examples" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> First set of Examples</h3>
<p>Let’s take a look at the following three examples and think about what themes and topics they cover. More importantly, let’s think about <em>how</em> we “assign” those themes and topics. What is out thinking process? What textual elements do we keep in mind when we argue that such and such text is about such and such topics?</p>
<p><strong>Example 1</strong>: <em>March 27, 1862</em> — Light Artillery</p>
<p>I am authorized by the Governor of Virginia to raise a Company of Light Artillery for the war. All those desirous of enlisting in this the most effective arm of the service, would do well to call at once at the office of Johnson &amp; Guigon, Whig Building. Uniforms and subsistence furnished. A.B.GUIGON. mh 25—6t</p>
<p><strong>Example 2</strong>: <em>August 17, 1864</em> — Royal Marriages.</p>
<p>There is a story circulated in Germany, and some in Paris, that the match between the heir-apparent of the Imperial throne of Russia and the Princess Dagmar of Denmark having been definitively broken off, another is in the course of negotiation between His Imperial Highness and the Princess Helens of England.</p>
<p><strong>Example 3</strong>: <em>June 22, 1863</em> — News from Europe.</p>
<p>The steamship Scotia arrived at New York on Thursday from Europe, with foreign news to the 7th inst. The news is not important. The Confederate steamer Lord Clyde was searched by order of the British Government, but nothing contraband being found on board her she was permitted to sail. The Russians have been defeated near Grochoury by the Polish insurgents. The three Powers have sent an earnest note to Russia, asking for a representative Government, a general amnesty, and an immediate cessation of hostilities in Poland.</p>
</div>
<div id="second-set-of-examples" class="section level3" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Second Set of Examples</h3>
<p><strong>Example 1</strong>: <em>March 27, 1862</em> — Light Artillery</p>
<p>I am authorized by the Governor of Virginia to raise a Company of Light Artillery for the war. All those desirous of enlisting in this the most effective arm of the service, would do well to call at once at the office of Johnson &amp; Guigon, Whig Building. Uniforms and subsistence furnished. A.B.Guigon. mh 25—6t</p>
<p><strong>Example 2</strong>: <em>July 17, 1861</em> — Another improvement in fire-arms</p>
<p>Mr. T.W.Cofer, of Portsmouth, Va., has just completed an improvement in revolving fire-arms by which the process of loading is so much facilitated that the ordinary Colt or other Revolver, with this improvement attached, may be loaded and discharged with fourfold rapidity. Mr.Cofer left that place for Richmond yesterday for the purpose of securing a patent for his invention.</p>
<p><strong>Example 3</strong>: <em>January 21, 186!</em> — [Advertisement]</p>
<p>Just received and for sale low, a complete assortment of Colt’s, Sharpe’s, Smith <em>&amp;</em> Wesson’s, and other Revolvers. A call is solicited from those in want of anything in the Gun way. T.W.Tignor, Gun Maker, Main st., below the Market.</p>
<p><strong>Example 4</strong>: <em>December 17, 1861</em> — Unlawful shooting</p>
<p>On Saturday night, while Peter Padractti was pursuing the even tenor of his way on 11th and Cary streets, a man in a sky blue coat approached and discharged a pistol at him, and made use of most fearful expletives, which were quite enough to alarm a peaceful citizen. The strange individual, who was soon afterward arrested, gave his name as William Leftwich. When arraigned before the Mayor yesterday, he represented that he was a soldier on furlough, and was quite oblivious when he performed the deed which he now deeply deplored. The Mayor remanded him for indictment.</p>
<p><strong>Example 5</strong>: <em>January 18, 1861</em> — South Carolina Legislature</p>
<p>Charleston, S.C., January 17. The Senate report of the Military Committee, for raising four companies of artillery to meet the exigencies of the times, that demand South Carolina to be on a war footing, meets no opposers from any quarter, it being the general impression that she should have permanent military establishments for garrison purposes in the State fortifications. This establishment, the Committee recommend, to consist of a regiment of four companies, as it will form the nucleus around which volunteers and militia can rally, and will, besides, be a peace establishment, or furnish South Carolina ‘s quota in the army of the Southern Confederacy. The Senate went into secret session on the proposition to lay a submarine telegraph between Charleston, Morris’ Island, Forts Moultrie, Johnson, Castle Pinckney, <em>&amp;</em>c.</p>
<p><strong>Example 6</strong>: <em>May 29, 1861</em> — For the defence of Virginia</p>
<p>Twenty five men are wanted to enlist in the ranks of the Henrico Artillery under the command of Major Johnson H. Sands now encamped at Richmond College, one mile from this city, already mustered into service, and daily expecting orders to go into active duty. Rendezvous on Main street, between 7th and 8th. Hours between 10 A.M. and 3 P.M. H.Lansing Burrows, Recruiting Officer.</p>
<!--
## Topic Modeling

The formal definition of *topic modeling* is "..." (Source: ...)
-->
</div>
</div>
<div id="implementation" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Implementation</h2>
<p><strong>1. Preparing Data.</strong> First, we need to make sure to convert the Dispatch into a suitable format. As I stressed before, TSV/CSV tabular format is one of the most universal. Let’s go back to our reformatting script and change it in such a way that it collects data in the TSV format (TSV will help us to avoid the issue with commas in the CSV format) and aggregates all articles published in the same year in one file. Additionally, we will prepare texts for topic modeling in the following manner (See, section <code>PART II: PREPARING TEXT FOR TM ANALYSIS</code> in the script below):</p>
<ul>
<li>create a new column with texts of articles;</li>
<li>remove all non word characters; convert everything to lower case; remove extra spaces;</li>
<li>split resulting normalized text into lists of tokens;</li>
<li>filter out stop words (provided in the long list <code>stop_words_custom</code>)
<ul>
<li>you can modify this list; as a rule of thumb, the stop word list is based on the frequency list of your data: you pick top 100 (or more) most frequent words; it is always a good idea to quickly check this list and may be keep some (for example, the word <em>Allãh</em> is one of the most frequent words in Arabic and you might want to keep it).</li>
</ul></li>
</ul>
<p>Our script will create 6 files from our Dispatch data (one per each year; years 1860 and 1865 are incomplete) with all necessary columns:</p>
<ul>
<li><code>id</code>: the unique ID of each text item (“article”)</li>
<li><code>month</code>: month of publication</li>
<li><code>date</code>: day of publication</li>
<li><code>type</code>: type of the “article”, if available</li>
<li><code>header</code>: header of the “article”, if available</li>
<li><code>text</code>: text of the “article” in its original form (<code>\n</code> replaced with <code>;;;</code>)</li>
<li><code>textDataLists</code>: these are the filtered word lists that will be used in TM</li>
</ul>
<p>You can get the script from here: <a href="./files/tm_scripts/topic_modeling_script01.py"><code>topic_modeling_script01.py</code></a>. Make sure to change <code>source</code> and <code>target</code> folders accordingly; I would recommend to keep <code>target</code> as is, just make sure to create that folder.</p>
<p>Successful execution of this script will prepare you for the next step.</p>
<p><strong>NB:</strong> possible improvements of this step may include <em>lemmatization</em> and/or <em>stemming</em>; these steps will reduce the linguistic complexity of text in different ways and will allow to group texts in a different way (this is usually considered to be a better practice, but any reduction also leads to loss of some information, which mat be valuable.) The most optimal way would be to create additional columns with lemmatized and stemmed texts (with most frequent words also filtered out).</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the script converts Dispatch data into TSV and prepares text for topic modeling</span></span>
<span id="cb60-2"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re, os, io</span>
<span id="cb60-4"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gensim</span>
<span id="cb60-5"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.utils <span class="im">import</span> simple_preprocess</span>
<span id="cb60-6"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb60-7"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-8" aria-hidden="true" tabindex="-1"></a>source <span class="op">=</span> <span class="st">&quot;./Dispatch/&quot;</span></span>
<span id="cb60-9"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-9" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="st">&quot;./Dispatch_Processed_TSV/&quot;</span>  <span class="co"># needs to be created beforehand!</span></span>
<span id="cb60-10"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;&quot;&quot;</span></span>
<span id="cb60-12"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="st">    ######################################################</span></span>
<span id="cb60-13"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="st">    Preparing text data for topic modeling</span></span>
<span id="cb60-14"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="st">    ######################################################</span></span>
<span id="cb60-15"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span>)</span>
<span id="cb60-16"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_words(texts, word_list_filter):</span>
<span id="cb60-18"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[word <span class="cf">for</span> word <span class="kw">in</span> simple_preprocess(<span class="bu">str</span>(doc)) <span class="cf">if</span> word <span class="kw">not</span> <span class="kw">in</span> word_list_filter] <span class="cf">for</span> doc <span class="kw">in</span> texts]</span>
<span id="cb60-19"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sent_to_words(sentences):</span>
<span id="cb60-21"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sentence <span class="kw">in</span> sentences:</span>
<span id="cb60-22"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span>(gensim.utils.simple_preprocess(<span class="bu">str</span>(sentence), deacc<span class="op">=</span><span class="va">True</span>))  <span class="co"># deacc=True removes punctuations</span></span>
<span id="cb60-23"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convertDispatchToCSV(source, target, YEAR):</span>
<span id="cb60-25"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PART I: AGGREGATING ALL into LARGE TSV</span></span>
<span id="cb60-26"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">Collecting data for year: </span><span class="sc">%s</span><span class="st">&quot;</span> <span class="op">%</span> YEAR)</span>
<span id="cb60-27"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-27" aria-hidden="true" tabindex="-1"></a>    issueVar <span class="op">=</span> []</span>
<span id="cb60-28"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-28" aria-hidden="true" tabindex="-1"></a>    lof <span class="op">=</span> os.listdir(source)</span>
<span id="cb60-29"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> f <span class="kw">in</span> lof:</span>
<span id="cb60-30"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> f.startswith(<span class="st">&quot;dltext&quot;</span>):  <span class="co"># fileName test</span></span>
<span id="cb60-31"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-31" aria-hidden="true" tabindex="-1"></a>            c <span class="op">=</span> <span class="dv">0</span>  <span class="co"># technical counter</span></span>
<span id="cb60-32"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(source <span class="op">+</span> f, <span class="st">&quot;r&quot;</span>, encoding<span class="op">=</span><span class="st">&quot;utf8&quot;</span>) <span class="im">as</span> f1:</span>
<span id="cb60-33"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-33" aria-hidden="true" tabindex="-1"></a>                text <span class="op">=</span> f1.read()</span>
<span id="cb60-34"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-34" aria-hidden="true" tabindex="-1"></a>                date <span class="op">=</span> re.search(<span class="vs">r&#39;&lt;date value=&quot;([\d-]+)&quot;&#39;</span>, text).group(<span class="dv">1</span>)</span>
<span id="cb60-35"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-36"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> date[:<span class="dv">4</span>] <span class="op">==</span> <span class="bu">str</span>(YEAR):</span>
<span id="cb60-37"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-37" aria-hidden="true" tabindex="-1"></a>                    split <span class="op">=</span> re.split(<span class="st">&quot;&lt;div3 &quot;</span>, text)</span>
<span id="cb60-38"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-39"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-39" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> s <span class="kw">in</span> split[<span class="dv">1</span>:]:</span>
<span id="cb60-40"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-40" aria-hidden="true" tabindex="-1"></a>                        c <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-41"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-41" aria-hidden="true" tabindex="-1"></a>                        s <span class="op">=</span> <span class="st">&quot;&lt;div3 &quot;</span> <span class="op">+</span> s  <span class="co"># a step to restore the integrity of items</span></span>
<span id="cb60-42"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-43" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">try</span>:</span>
<span id="cb60-44"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-44" aria-hidden="true" tabindex="-1"></a>                            unitType <span class="op">=</span> re.search(</span>
<span id="cb60-45"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-45" aria-hidden="true" tabindex="-1"></a>                                <span class="vs">r&#39;type=&quot;([^\&quot;]+)&quot;&#39;</span>, s).group(<span class="dv">1</span>)</span>
<span id="cb60-46"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-46" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">except</span>:</span>
<span id="cb60-47"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-47" aria-hidden="true" tabindex="-1"></a>                            unitType <span class="op">=</span> <span class="st">&quot;noType&quot;</span></span>
<span id="cb60-48"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-49" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">try</span>:</span>
<span id="cb60-50"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-50" aria-hidden="true" tabindex="-1"></a>                            header <span class="op">=</span> re.search(</span>
<span id="cb60-51"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-51" aria-hidden="true" tabindex="-1"></a>                                <span class="vs">r&#39;&lt;head.*&lt;/head&gt;&#39;</span>, s).group(<span class="dv">0</span>)</span>
<span id="cb60-52"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-52" aria-hidden="true" tabindex="-1"></a>                            header <span class="op">=</span> re.sub(<span class="st">&quot;&lt;[^&lt;]+&gt;&quot;</span>, <span class="st">&quot;&quot;</span>, header)</span>
<span id="cb60-53"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-54"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-54" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">except</span>:</span>
<span id="cb60-55"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-55" aria-hidden="true" tabindex="-1"></a>                            header <span class="op">=</span> <span class="st">&quot;NO HEADER&quot;</span></span>
<span id="cb60-56"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-57"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-57" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> s</span>
<span id="cb60-58"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-58" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="st">&quot;&lt;[^&lt;]+&gt;&quot;</span>, <span class="st">&quot; &quot;</span>, text)</span>
<span id="cb60-59"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-59" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="vs">r&quot;\t&quot;</span>, <span class="st">&quot; &quot;</span>, text)</span>
<span id="cb60-60"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-60" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="st">&quot; +</span><span class="ch">\n</span><span class="st">|</span><span class="ch">\n</span><span class="st"> +&quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, text)</span>
<span id="cb60-61"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-61" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> text.strip()</span>
<span id="cb60-62"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-62" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">+&quot;</span>, <span class="st">&quot;;;; &quot;</span>, text)</span>
<span id="cb60-63"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-63" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="st">&quot; +&quot;</span>, <span class="st">&quot; &quot;</span>, text)</span>
<span id="cb60-64"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-64" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="vs">r&quot; ([\.,:;!])&quot;</span>, <span class="vs">r&quot;\1&quot;</span>, text)</span>
<span id="cb60-65"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-66"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-66" aria-hidden="true" tabindex="-1"></a>                        itemID <span class="op">=</span> date <span class="op">+</span> <span class="st">&quot;_&quot;</span> <span class="op">+</span> unitType <span class="op">+</span> <span class="st">&quot;_</span><span class="sc">%04d</span><span class="st">&quot;</span> <span class="op">%</span> c</span>
<span id="cb60-67"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-68"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-68" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">len</span>(re.sub(<span class="st">&quot;\W+&quot;</span>, <span class="st">&quot;&quot;</span>, text)) <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb60-69"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-69" aria-hidden="true" tabindex="-1"></a>                            var <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>.join(</span>
<span id="cb60-70"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-70" aria-hidden="true" tabindex="-1"></a>                                [itemID, date, unitType, header, text])</span>
<span id="cb60-71"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-71" aria-hidden="true" tabindex="-1"></a>                            issueVar.append(var)</span>
<span id="cb60-72"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-73"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-73" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\t\t</span><span class="st">collected: </span><span class="sc">%d</span><span class="st"> items&quot;</span> <span class="op">%</span> <span class="bu">len</span>(issueVar))</span>
<span id="cb60-74"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-74" aria-hidden="true" tabindex="-1"></a>    issueNew <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>.join(issueVar)</span>
<span id="cb60-75"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-75" aria-hidden="true" tabindex="-1"></a>    header <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>.join([<span class="st">&quot;id&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;header&quot;</span>, <span class="st">&quot;text&quot;</span>])</span>
<span id="cb60-76"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-76" aria-hidden="true" tabindex="-1"></a>    final <span class="op">=</span> header <span class="op">+</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> issueNew</span>
<span id="cb60-77"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-78"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PART II: PREPARING TEXT FOR TM ANALYSIS</span></span>
<span id="cb60-79"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Now, we prepare text data for TM (into a separate column)</span></span>
<span id="cb60-80"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-80" aria-hidden="true" tabindex="-1"></a>    entitiesFinalStringIO <span class="op">=</span> io.StringIO(final)</span>
<span id="cb60-81"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-81" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(entitiesFinalStringIO, sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb60-82"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-83"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-83" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> df</span>
<span id="cb60-84"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-84" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-85"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-85" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;month&quot;</span>] <span class="op">=</span> [re.sub(<span class="st">&quot;-\d\d$&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="bu">str</span>(i)) <span class="cf">for</span> i <span class="kw">in</span> dispatch[<span class="st">&quot;date&quot;</span>]]</span>
<span id="cb60-86"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-86" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;month&quot;</span>] <span class="op">=</span> pd.to_datetime(dispatch[<span class="st">&quot;month&quot;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%Y-%m&quot;</span>)</span>
<span id="cb60-87"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-87" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;date&quot;</span>] <span class="op">=</span> pd.to_datetime(dispatch[<span class="st">&quot;date&quot;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>)</span>
<span id="cb60-88"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-89"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reorder columns</span></span>
<span id="cb60-90"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-90" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch[[<span class="st">&quot;id&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;header&quot;</span>, <span class="st">&quot;text&quot;</span>]]</span>
<span id="cb60-91"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-92"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove empty articles</span></span>
<span id="cb60-93"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-93" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch[dispatch.<span class="bu">type</span> <span class="op">!=</span> <span class="st">&quot;ad-blank&quot;</span>]</span>
<span id="cb60-94"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-95"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># drop=True -- use it to avoid creating a new column with the old index values</span></span>
<span id="cb60-96"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-96" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-97"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-98"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-98" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textData&quot;</span>] <span class="op">=</span> dispatch[<span class="st">&quot;text&quot;</span>]</span>
<span id="cb60-99"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-99" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textData&quot;</span>] <span class="op">=</span> [re.sub(<span class="st">&quot;\W+&quot;</span>, <span class="st">&quot; &quot;</span>, <span class="bu">str</span>(i).lower()) <span class="cf">for</span> i <span class="kw">in</span> dispatch[<span class="st">&quot;textData&quot;</span>]]</span>
<span id="cb60-100"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-100" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textData&quot;</span>] <span class="op">=</span> [re.sub(<span class="st">&quot; +&quot;</span>, <span class="st">&quot; &quot;</span>, <span class="bu">str</span>(i).lower()) <span class="cf">for</span> i <span class="kw">in</span> dispatch[<span class="st">&quot;textData&quot;</span>]]</span>
<span id="cb60-101"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-102"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-102" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textDataLists&quot;</span>] <span class="op">=</span> <span class="bu">list</span>(sent_to_words(dispatch[<span class="st">&quot;textData&quot;</span>].copy()))</span>
<span id="cb60-103"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-104"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># you can expand the stop word list by adding more high frequency words</span></span>
<span id="cb60-105"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-105" aria-hidden="true" tabindex="-1"></a>    stop_words_custom <span class="op">=</span> [<span class="st">&quot;the&quot;</span>, <span class="st">&quot;of&quot;</span>, <span class="st">&quot;and&quot;</span>, <span class="st">&quot;to&quot;</span>, <span class="st">&quot;in&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;that&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;on&quot;</span>, <span class="st">&quot;was&quot;</span>, <span class="st">&quot;is&quot;</span>, <span class="st">&quot;at&quot;</span>, <span class="st">&quot;be&quot;</span>, <span class="st">&quot;by&quot;</span>,</span>
<span id="cb60-106"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-106" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;from&quot;</span>, <span class="st">&quot;his&quot;</span>, <span class="st">&quot;he&quot;</span>, <span class="st">&quot;it&quot;</span>, <span class="st">&quot;with&quot;</span>, <span class="st">&quot;as&quot;</span>, <span class="st">&quot;this&quot;</span>, <span class="st">&quot;will&quot;</span>, <span class="st">&quot;which&quot;</span>, <span class="st">&quot;have&quot;</span>, <span class="st">&quot;or&quot;</span>, <span class="st">&quot;are&quot;</span>,</span>
<span id="cb60-107"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-107" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;they&quot;</span>, <span class="st">&quot;their&quot;</span>, <span class="st">&quot;not&quot;</span>, <span class="st">&quot;were&quot;</span>, <span class="st">&quot;been&quot;</span>, <span class="st">&quot;has&quot;</span>, <span class="st">&quot;our&quot;</span>, <span class="st">&quot;we&quot;</span>, <span class="st">&quot;all&quot;</span>, <span class="st">&quot;but&quot;</span>, <span class="st">&quot;one&quot;</span>, <span class="st">&quot;had&quot;</span>,</span>
<span id="cb60-108"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-108" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;who&quot;</span>, <span class="st">&quot;an&quot;</span>, <span class="st">&quot;no&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;them&quot;</span>, <span class="st">&quot;about&quot;</span>, <span class="st">&quot;him&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;upon&quot;</span>, <span class="st">&quot;may&quot;</span>, <span class="st">&quot;there&quot;</span>, <span class="st">&quot;any&quot;</span>,</span>
<span id="cb60-109"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-109" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;some&quot;</span>, <span class="st">&quot;so&quot;</span>, <span class="st">&quot;men&quot;</span>, <span class="st">&quot;when&quot;</span>, <span class="st">&quot;if&quot;</span>, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;her&quot;</span>, <span class="st">&quot;under&quot;</span>, <span class="st">&quot;would&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;such&quot;</span>, <span class="st">&quot;made&quot;</span>,</span>
<span id="cb60-110"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-110" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;up&quot;</span>, <span class="st">&quot;last&quot;</span>, <span class="st">&quot;j&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;years&quot;</span>, <span class="st">&quot;other&quot;</span>, <span class="st">&quot;into&quot;</span>, <span class="st">&quot;said&quot;</span>, <span class="st">&quot;new&quot;</span>, <span class="st">&quot;very&quot;</span>, <span class="st">&quot;five&quot;</span>,</span>
<span id="cb60-111"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-111" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;after&quot;</span>, <span class="st">&quot;out&quot;</span>, <span class="st">&quot;these&quot;</span>, <span class="st">&quot;shall&quot;</span>, <span class="st">&quot;my&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;more&quot;</span>, <span class="st">&quot;its&quot;</span>, <span class="st">&quot;now&quot;</span>, <span class="st">&quot;before&quot;</span>, <span class="st">&quot;three&quot;</span>,</span>
<span id="cb60-112"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-112" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;m&quot;</span>, <span class="st">&quot;than&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;th&quot;</span>, <span class="st">&quot;o&#39;clock&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;old&quot;</span>, <span class="st">&quot;being&quot;</span>, <span class="st">&quot;left&quot;</span>, <span class="st">&quot;can&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;only&quot;</span>, <span class="st">&quot;same&quot;</span>,</span>
<span id="cb60-113"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-113" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;act&quot;</span>, <span class="st">&quot;first&quot;</span>, <span class="st">&quot;between&quot;</span>, <span class="st">&quot;above&quot;</span>, <span class="st">&quot;she&quot;</span>, <span class="st">&quot;you&quot;</span>, <span class="st">&quot;place&quot;</span>, <span class="st">&quot;following&quot;</span>, <span class="st">&quot;do&quot;</span>, <span class="st">&quot;per&quot;</span>,</span>
<span id="cb60-114"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-114" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;every&quot;</span>, <span class="st">&quot;most&quot;</span>, <span class="st">&quot;near&quot;</span>, <span class="st">&quot;us&quot;</span>, <span class="st">&quot;good&quot;</span>, <span class="st">&quot;should&quot;</span>, <span class="st">&quot;having&quot;</span>, <span class="st">&quot;great&quot;</span>, <span class="st">&quot;also&quot;</span>, <span class="st">&quot;over&quot;</span>,</span>
<span id="cb60-115"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-115" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;r&quot;</span>, <span class="st">&quot;could&quot;</span>, <span class="st">&quot;twenty&quot;</span>, <span class="st">&quot;people&quot;</span>, <span class="st">&quot;those&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;without&quot;</span>, <span class="st">&quot;four&quot;</span>, <span class="st">&quot;received&quot;</span>, <span class="st">&quot;p&quot;</span>, <span class="st">&quot;then&quot;</span>,</span>
<span id="cb60-116"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-116" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;what&quot;</span>, <span class="st">&quot;well&quot;</span>, <span class="st">&quot;where&quot;</span>, <span class="st">&quot;must&quot;</span>, <span class="st">&quot;says&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;large&quot;</span>, <span class="st">&quot;against&quot;</span>, <span class="st">&quot;back&quot;</span>, <span class="st">&quot;through&quot;</span>,</span>
<span id="cb60-117"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-117" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;b&quot;</span>, <span class="st">&quot;off&quot;</span>, <span class="st">&quot;few&quot;</span>, <span class="st">&quot;me&quot;</span>, <span class="st">&quot;sent&quot;</span>, <span class="st">&quot;while&quot;</span>, <span class="st">&quot;make&quot;</span>, <span class="st">&quot;number&quot;</span>, <span class="st">&quot;many&quot;</span>, <span class="st">&quot;much&quot;</span>, <span class="st">&quot;give&quot;</span>,</span>
<span id="cb60-118"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-118" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;six&quot;</span>, <span class="st">&quot;down&quot;</span>, <span class="st">&quot;several&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;since&quot;</span>, <span class="st">&quot;little&quot;</span>, <span class="st">&quot;during&quot;</span>, <span class="st">&quot;away&quot;</span>, <span class="st">&quot;until&quot;</span>,</span>
<span id="cb60-119"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-119" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;each&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;own&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;here&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;found&quot;</span>, <span class="st">&quot;reported&quot;</span>,</span>
<span id="cb60-120"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-120" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;right&quot;</span>, <span class="st">&quot;given&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;your&quot;</span>, <span class="st">&quot;way&quot;</span>, <span class="st">&quot;side&quot;</span>, <span class="st">&quot;did&quot;</span>, <span class="st">&quot;part&quot;</span>, <span class="st">&quot;long&quot;</span>, <span class="st">&quot;next&quot;</span>, <span class="st">&quot;fifty&quot;</span>,</span>
<span id="cb60-121"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-121" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;another&quot;</span>, <span class="st">&quot;1st&quot;</span>, <span class="st">&quot;whole&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;still&quot;</span>, <span class="st">&quot;among&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;within&quot;</span>, <span class="st">&quot;get&quot;</span>, <span class="st">&quot;named&quot;</span>, <span class="st">&quot;f&quot;</span>,</span>
<span id="cb60-122"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-122" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;l&quot;</span>, <span class="st">&quot;himself&quot;</span>, <span class="st">&quot;ten&quot;</span>, <span class="st">&quot;both&quot;</span>, <span class="st">&quot;nothing&quot;</span>, <span class="st">&quot;again&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;thirty&quot;</span>, <span class="st">&quot;eight&quot;</span>, <span class="st">&quot;took&quot;</span>,</span>
<span id="cb60-123"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-123" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;never&quot;</span>, <span class="st">&quot;came&quot;</span>, <span class="st">&quot;called&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;passed&quot;</span>, <span class="st">&quot;just&quot;</span>, <span class="st">&quot;brought&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;further&quot;</span>,</span>
<span id="cb60-124"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-124" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;yet&quot;</span>, <span class="st">&quot;half&quot;</span>, <span class="st">&quot;far&quot;</span>, <span class="st">&quot;held&quot;</span>, <span class="st">&quot;soon&quot;</span>, <span class="st">&quot;main&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;however&quot;</span>, <span class="st">&quot;say&quot;</span>,</span>
<span id="cb60-125"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-125" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;heavy&quot;</span>, <span class="st">&quot;thus&quot;</span>, <span class="st">&quot;hereby&quot;</span>, <span class="st">&quot;even&quot;</span>, <span class="st">&quot;ran&quot;</span>, <span class="st">&quot;come&quot;</span>, <span class="st">&quot;whom&quot;</span>, <span class="st">&quot;like&quot;</span>, <span class="st">&quot;cannot&quot;</span>, <span class="st">&quot;head&quot;</span>,</span>
<span id="cb60-126"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-126" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;ever&quot;</span>, <span class="st">&quot;themselves&quot;</span>, <span class="st">&quot;put&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;cause&quot;</span>, <span class="st">&quot;known&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;go&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;once&quot;</span>, <span class="st">&quot;therefore&quot;</span>,</span>
<span id="cb60-127"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-127" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;thursday&quot;</span>, <span class="st">&quot;full&quot;</span>, <span class="st">&quot;apply&quot;</span>, <span class="st">&quot;see&quot;</span>, <span class="st">&quot;though&quot;</span>, <span class="st">&quot;seven&quot;</span>, <span class="st">&quot;tuesday&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;done&quot;</span>,</span>
<span id="cb60-128"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-128" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;whose&quot;</span>, <span class="st">&quot;let&quot;</span>, <span class="st">&quot;how&quot;</span>, <span class="st">&quot;making&quot;</span>, <span class="st">&quot;immediately&quot;</span>, <span class="st">&quot;forty&quot;</span>, <span class="st">&quot;early&quot;</span>, <span class="st">&quot;wednesday&quot;</span>,</span>
<span id="cb60-129"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-129" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;either&quot;</span>, <span class="st">&quot;too&quot;</span>, <span class="st">&quot;amount&quot;</span>, <span class="st">&quot;fact&quot;</span>, <span class="st">&quot;heard&quot;</span>, <span class="st">&quot;receive&quot;</span>, <span class="st">&quot;short&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;100&quot;</span>,</span>
<span id="cb60-130"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-130" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;know&quot;</span>, <span class="st">&quot;might&quot;</span>, <span class="st">&quot;except&quot;</span>, <span class="st">&quot;supposed&quot;</span>, <span class="st">&quot;others&quot;</span>, <span class="st">&quot;doubt&quot;</span>, <span class="st">&quot;set&quot;</span>, <span class="st">&quot;works&quot;</span>,</span>
<span id="cb60-131"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-131" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># MANUALLY ADDED AFTER TOPIC RESULTS REVIEW</span></span>
<span id="cb60-132"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-132" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;ts&quot;</span>, <span class="st">&quot;amp&quot;</span>, <span class="st">&quot;co&quot;</span>, <span class="st">&quot;st&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;dec&quot;</span>, <span class="st">&quot;december&quot;</span>, <span class="st">&quot;november&quot;</span>, <span class="st">&quot;october&quot;</span>, <span class="st">&quot;richmond&quot;</span>]</span>
<span id="cb60-133"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-134"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-134" aria-hidden="true" tabindex="-1"></a>    <span class="co"># TEXT CLEANING</span></span>
<span id="cb60-135"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-135" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textDataLists&quot;</span>] <span class="op">=</span> remove_words(dispatch[<span class="st">&quot;textDataLists&quot;</span>], stop_words_custom)</span>
<span id="cb60-136"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-136" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch[[<span class="st">&quot;id&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;header&quot;</span>, <span class="st">&quot;text&quot;</span>, <span class="st">&quot;textDataLists&quot;</span>]]</span>
<span id="cb60-137"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-137" aria-hidden="true" tabindex="-1"></a>    dispatch.to_csv(target <span class="op">+</span> <span class="st">&quot;Dispatch_</span><span class="sc">%s</span><span class="st">_tmReady.tsv&quot;</span> <span class="op">%</span> <span class="bu">str</span>(YEAR), sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb60-138"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-138" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\t\t</span><span class="st">saved to: Dispatch_</span><span class="sc">%s</span><span class="st">_tmReady.tsv&quot;</span> <span class="op">%</span> <span class="bu">str</span>(YEAR))</span>
<span id="cb60-139"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-140"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-141"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-141" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1860</span>)</span>
<span id="cb60-142"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-142" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1861</span>)</span>
<span id="cb60-143"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-143" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1862</span>)</span>
<span id="cb60-144"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-144" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1863</span>)</span>
<span id="cb60-145"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-145" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1864</span>)</span>
<span id="cb60-146"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb60-146" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1865</span>)</span></code></pre></div>
<p><strong>2. Running Topic Modeling (with <code>gensim</code>)</strong></p>
<p>In the next script we will load all the preprocessed data and run topic modeling.</p>
<p>In the code below I have added one more parameter: <code>random_state</code> (used in <code>gensim.models.LdaModel</code> function). This parameter is crucial for reproducibility. The issue with generating statistical models is that they always get generated slightly differently. In order to avoid this, we can use <code>random_state</code> parameter with the same number (<code>random_state = 2023</code>); the number itself is not important; what is important is that you reuse the same number, which will guarantee the same results.</p>
<p>You will see that there is a section <code># VARIABLES</code> at the beginning of the script. This is a rather convenient way to keep all key variables that you might want to change in one place for easier script adjustment (especially when they are scattered across a long script). Here we determine the <code>seed_value</code> for the <code>random_state</code> parameter, and the range of numbers of topics for which we want to run our test. The <code>fileSuffix</code> is a suffix that will be automatically added to generated files, allowing to keep results of different tests separate and clear.</p>
<p>You can see that there are several <code>print()</code> statements in the script. These are very convenient to keep you informed on the progress.</p>
<p>The output of the script (for each run with different parameters in <code># VARIABLES</code>) will generate a set of files:</p>
<ol style="list-style-type: decimal">
<li>the LDA model for the selected number of topics;</li>
<li>topic “names” as a json file (names include most frequent terms);</li>
<li>topic-word probabilities for each topic for SNA (see next lesson);</li>
<li>topic probabilities — the main output file — which includes columns with topic probabilities for each “article”l in order to save space, only the column with IDs is included from the original table (we can merge these results with the complete original whenever we need later).</li>
</ol>
<p>You can get the script from here: <a href="./files/tm/topic_modeling_script02.py"><code>topic_modeling_script02.py</code></a>. Make sure to change <code>dispatchSubfolder</code> if necessary. Keep in mind that running this script with a high number of topics (<code>maxTopic</code>) is likely to take quite a while.</p>
<p>(One important note: because of some issues with code duplication in <code>gensim</code> (see, <a href="https://github.com/RaRe-Technologies/gensim/issues/2291">here</a>) it is recommended to wrap the main code into <code>main()</code> function.
)</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to be added later</span></span></code></pre></div>
<p><strong>3. Finding the Optimal Number of Topics (with <code>gensim</code>)</strong></p>
<p>The number of topics is a tricky issue, since we pre-determine this number and the algorithm then splits all data into that number of topics. In other words, if you tell the machine to find 10 topics, it will use 10 buckets to sort all the data into; if you give it 20, it will do that for 20. For this reason topic modeling often takes multiple attempts. Additionally, it is not uncommon to then pull out a specific topic from your data and re-run the algorithm on that subset of texts.</p>
<p>Nonetheless, there is a mathematical way that may help to identify the optimal number of topics. The common practice is to generate several models and calculate coherence score (k) for them all—the number with the highest coherence score is considered optimal (ideally, above 0.55).</p>
<p>The output of the script (for each run with different parameters in <code># VARIABLES</code>) will generate two files: (1) a TSV file with two columns — the number of topics and corresponding coherence scores; and (2) a graph that visualizes these results. You can reuse the TSV file to graph them differently without rerunning the entire script.</p>
<p>You can get the script from here: <a href="./files/tm/topic_modeling_script03.py"><code>topic_modeling_script03.py</code></a>. Make sure to change <code>dispatchSubfolder</code> if necessary. Keep in mind that running this script with a high number of topics (<code>maxTopic</code>) is likely to take quite a while.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to be added later</span></span></code></pre></div>
<p><strong>4. Analyzing Topic Modeling Data</strong></p>
<p>The next script will run a series of analyses on the topic modeling data that we generated in the previous steps. These will include:</p>
<ul>
<li>graphing the distribution of topics over time;</li>
<li>extract texts that are most representative of each topic;</li>
</ul>
<p>…</p>
<p><strong>5. Training a Model</strong> …</p>
<p>**</p>
</div>
<div id="tf-idf" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> TF-IDF</h2>
<p>TF-IDF is the most common automatic method for identifying keywords in texts. This method is the standard approach for identifying keywords. It was first proposed almost fifty years ago by <span class="citation">Spärck Jones (<a href="#ref-SPARCKJONESStatistical1972" role="doc-biblioref">1972</a>)</span>; <span class="citation">Ramsay (<a href="#ref-RamsayReading2011" role="doc-biblioref">2011</a>)</span>, in Chapter 1, offers a detailed humanistic explanation of this approach.</p>
<p>This approach is statistical in its nature and therefore requires a sizable collection of texts for meaningful results. In the case of small collections you are likely to observe that the selection of keywords for the same text change significantly with every new addition to the collection of texts. This is because the method takes into account frequencies of each word and the number of documents in which this word occurs. For example, if your collection includes 10 articles that discuss different aspects of the ʿAbbāsid caliphate, with some focused on politics, some on economics, and some on culture, the word “ʿAbbāsid” will most likely not be included into the list of suggested keywords (since all articles have this term), but words like “politics”, “economics”, and “culture” will be in this list, since they appear only in some articles. If you add ten other articles to your collection—and these will deal, say, with the Ottomans—then the word “ʿAbbāsid” will crawl up in the list of keywords for articles dealing with the ʿAbbasids. In other words, if your collection includes texts on the same broad topic (say, the ʿAbbāsids), the TF-IDF algorithm will assign high <em>keywordness</em> to those terms that point to narrower subjects within the broader subject of the ʿAbbāsids.</p>
<p>In cases when one has to run the topic modeling algorithm on a very large collection of texts, TF-IDF can be used in order to reduce the size of the corpus. That is to say, the corpus is first reduced to the TF-IDF abstractions and then the topic modeling algorithm is applied to these abstractions rather than to the complete initial texts.</p>
<p>TF-IDF abstractions can also be used to identify texts on similar topics across a large corpus of texts. In this approach one would calculate the distance between the vectors of TF-IDF abstractions. This approach mathematically checks whether to what extent two different documents share keywords and to what extent the numeric values of these keywords are similar: the more keywords they share and the more similar the keyword values are, the more similar the texts will be. (<a href="https://maximromanov.github.io/univie2020/lesson-10.html">More details…</a>.)</p>
</div>
<div id="implementation-in-jupyter-notebook" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> Implementation in Jupyter Notebook</h2>
<p>Jupyter notebooks is a very popular alternative to regular python scripts. You can try the same code with a jupyter notebook as well. There are some advantages and disadvantages to using them. JN can be quite useful when you are experimenting with some fast operations when you explore your dataset and want to try different things like graphs or data reshaping. If your code requires long time to run, JN maybe rather inconvenient to use.</p>
<div id="jupyter-notebook-1" class="section level3" number="12.6.1">
<h3><span class="header-section-number">12.6.1</span> jupyter notebook</h3>
<p>From command line (in your working folder)</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># installing</span></span>
<span id="cb63-2"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install jupyter</span>
<span id="cb63-3"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># starting</span></span>
<span id="cb63-5"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="ex">jupyter</span> notebook</span></code></pre></div>
<!--
## installing from a jupyter notebook

The required libraries can also be installed directly from your Jupyter notebook as shown below---note `!` in front of `pip`. (*Note*: You might need to use `pip3` instead of `pip`, depending on your overall `python` setup)

```python
# installing
!pip install nltk
!pip install gensim
!pip install spacy
!pip install pyLDAvis
```
-->
<p>Your default browser should open something like this:</p>
<p><img src="files/jupyter01.png" /></p>
<p>Click on an <code>*.ipynb</code> file to open a notebook.</p>
</div>
</div>
<div id="files-scripts" class="section level2" number="12.7">
<h2><span class="header-section-number">12.7</span> Files &amp; Scripts</h2>
<ul>
<li><a href="./files/tm/0_processing_dispatch_data_to_TSV.py">Script that converts the Dispatch to TSV</a> files necessary for the Jupyter Notebook; generate these TSV files first, then you can start the Notebook</li>
<li><a href="./files/tm/0_tModeling_Dispatch_clean.ipynb">TM - Jupyter Notebook</a>
<ul>
<li>For Windows: you will need to deactivate <code>%time</code> in those blocks of code that have it (either delete it, or comment it out with <code>#</code>).</li>
</ul></li>
</ul>
</div>
<div id="HWL12" class="section level2" number="12.8">
<h2><span class="header-section-number">12.8</span> Homework</h2>
<ul>
<li>Finish the assigned task;</li>
<li>Annotate your script (i.e., add comment to every line of code describing what is happenning there);</li>
</ul>
<p><strong>Submitting homework:</strong></p>
<ul>
<li>Homework assignment must be submitted by the beginning of the next class;</li>
<li>Now, that you know how to use GitHub, you will be submitting your homework pushing it to github:
<ul>
<li>Create a relevant subfolder in your repository and place your HW files there; push them to your GitHub account;
<ul>
<li>Email me the link to your repository with a short message (Something like: <em>I have completed homework for Lesson 3, which is uploaded to my repository … in subfolder <code>L03</code></em>)</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="SolutionL12" class="section level2" number="12.9">
<h2><span class="header-section-number">12.9</span> Solution</h2>
<p>The solutions will be added soon…</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the script converts Dispatch data into TSV and prepares text for topic modeling</span></span>
<span id="cb64-2"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re, os, io</span>
<span id="cb64-4"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gensim</span>
<span id="cb64-5"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.utils <span class="im">import</span> simple_preprocess</span>
<span id="cb64-6"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb64-7"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-8" aria-hidden="true" tabindex="-1"></a>source <span class="op">=</span> <span class="st">&quot;./Dispatch/&quot;</span></span>
<span id="cb64-9"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-9" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="st">&quot;./Dispatch_Processed_TSV/&quot;</span>  <span class="co"># needs to be created beforehand!</span></span>
<span id="cb64-10"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_words(texts, word_list_filter):</span>
<span id="cb64-12"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[word <span class="cf">for</span> word <span class="kw">in</span> simple_preprocess(<span class="bu">str</span>(doc)) <span class="cf">if</span> word <span class="kw">not</span> <span class="kw">in</span> word_list_filter] <span class="cf">for</span> doc <span class="kw">in</span> texts]</span>
<span id="cb64-13"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sent_to_words(sentences):</span>
<span id="cb64-15"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sentence <span class="kw">in</span> sentences:</span>
<span id="cb64-16"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span>(gensim.utils.simple_preprocess(<span class="bu">str</span>(sentence), deacc<span class="op">=</span><span class="va">True</span>))  <span class="co"># deacc=True removes punctuations</span></span>
<span id="cb64-17"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convertDispatchToCSV(source, target, YEAR):</span>
<span id="cb64-19"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Collecting data for year: </span><span class="sc">%s</span><span class="st">&quot;</span> <span class="op">%</span> YEAR)</span>
<span id="cb64-20"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-20" aria-hidden="true" tabindex="-1"></a>    issueVar <span class="op">=</span> []</span>
<span id="cb64-21"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-21" aria-hidden="true" tabindex="-1"></a>    lof <span class="op">=</span> os.listdir(source)</span>
<span id="cb64-22"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> f <span class="kw">in</span> lof:</span>
<span id="cb64-23"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> f.startswith(<span class="st">&quot;dltext&quot;</span>):  <span class="co"># fileName test</span></span>
<span id="cb64-24"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-24" aria-hidden="true" tabindex="-1"></a>            c <span class="op">=</span> <span class="dv">0</span>  <span class="co"># technical counter</span></span>
<span id="cb64-25"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(source <span class="op">+</span> f, <span class="st">&quot;r&quot;</span>, encoding<span class="op">=</span><span class="st">&quot;utf8&quot;</span>) <span class="im">as</span> f1:</span>
<span id="cb64-26"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-26" aria-hidden="true" tabindex="-1"></a>                text <span class="op">=</span> f1.read()</span>
<span id="cb64-27"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-27" aria-hidden="true" tabindex="-1"></a>                date <span class="op">=</span> re.search(<span class="vs">r&#39;&lt;date value=&quot;([\d-]+)&quot;&#39;</span>, text).group(<span class="dv">1</span>)</span>
<span id="cb64-28"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-29"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-29" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> date[:<span class="dv">4</span>] <span class="op">==</span> <span class="bu">str</span>(YEAR):</span>
<span id="cb64-30"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-30" aria-hidden="true" tabindex="-1"></a>                    split <span class="op">=</span> re.split(<span class="st">&quot;&lt;div3 &quot;</span>, text)</span>
<span id="cb64-31"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-32"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-32" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> s <span class="kw">in</span> split[<span class="dv">1</span>:]:</span>
<span id="cb64-33"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-33" aria-hidden="true" tabindex="-1"></a>                        c <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb64-34"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-34" aria-hidden="true" tabindex="-1"></a>                        s <span class="op">=</span> <span class="st">&quot;&lt;div3 &quot;</span> <span class="op">+</span> s  <span class="co"># a step to restore the integrity of items</span></span>
<span id="cb64-35"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-36"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-36" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">try</span>:</span>
<span id="cb64-37"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-37" aria-hidden="true" tabindex="-1"></a>                            unitType <span class="op">=</span> re.search(</span>
<span id="cb64-38"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-38" aria-hidden="true" tabindex="-1"></a>                                <span class="vs">r&#39;type=&quot;([^\&quot;]+)&quot;&#39;</span>, s).group(<span class="dv">1</span>)</span>
<span id="cb64-39"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-39" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">except</span>:</span>
<span id="cb64-40"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-40" aria-hidden="true" tabindex="-1"></a>                            unitType <span class="op">=</span> <span class="st">&quot;noType&quot;</span></span>
<span id="cb64-41"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-42"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-42" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">try</span>:</span>
<span id="cb64-43"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-43" aria-hidden="true" tabindex="-1"></a>                            header <span class="op">=</span> re.search(</span>
<span id="cb64-44"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-44" aria-hidden="true" tabindex="-1"></a>                                <span class="vs">r&#39;&lt;head.*&lt;/head&gt;&#39;</span>, s).group(<span class="dv">0</span>)</span>
<span id="cb64-45"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-45" aria-hidden="true" tabindex="-1"></a>                            header <span class="op">=</span> re.sub(<span class="st">&quot;&lt;[^&lt;]+&gt;&quot;</span>, <span class="st">&quot;&quot;</span>, header)</span>
<span id="cb64-46"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-47"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-47" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">except</span>:</span>
<span id="cb64-48"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-48" aria-hidden="true" tabindex="-1"></a>                            header <span class="op">=</span> <span class="st">&quot;NO HEADER&quot;</span></span>
<span id="cb64-49"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-50"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-50" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> s</span>
<span id="cb64-51"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-51" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="st">&quot;&lt;[^&lt;]+&gt;&quot;</span>, <span class="st">&quot; &quot;</span>, text)</span>
<span id="cb64-52"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-52" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="vs">r&quot;\t&quot;</span>, <span class="st">&quot; &quot;</span>, text)</span>
<span id="cb64-53"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-53" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="st">&quot; +</span><span class="ch">\n</span><span class="st">|</span><span class="ch">\n</span><span class="st"> +&quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, text)</span>
<span id="cb64-54"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-54" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> text.strip()</span>
<span id="cb64-55"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-55" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">+&quot;</span>, <span class="st">&quot;;;; &quot;</span>, text)</span>
<span id="cb64-56"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-56" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="st">&quot; +&quot;</span>, <span class="st">&quot; &quot;</span>, text)</span>
<span id="cb64-57"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-57" aria-hidden="true" tabindex="-1"></a>                        text <span class="op">=</span> re.sub(<span class="vs">r&quot; ([\.,:;!])&quot;</span>, <span class="vs">r&quot;\1&quot;</span>, text)</span>
<span id="cb64-58"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-59"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-59" aria-hidden="true" tabindex="-1"></a>                        itemID <span class="op">=</span> date <span class="op">+</span> <span class="st">&quot;_&quot;</span> <span class="op">+</span> unitType <span class="op">+</span> <span class="st">&quot;_</span><span class="sc">%04d</span><span class="st">&quot;</span> <span class="op">%</span> c</span>
<span id="cb64-60"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-61"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-61" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">len</span>(re.sub(<span class="st">&quot;\W+&quot;</span>, <span class="st">&quot;&quot;</span>, text)) <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb64-62"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-62" aria-hidden="true" tabindex="-1"></a>                            var <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>.join(</span>
<span id="cb64-63"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-63" aria-hidden="true" tabindex="-1"></a>                                [itemID, date, unitType, header, text])</span>
<span id="cb64-64"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-64" aria-hidden="true" tabindex="-1"></a>                            issueVar.append(var)</span>
<span id="cb64-65"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-66"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-66" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">collected: </span><span class="sc">%d</span><span class="st"> items&quot;</span> <span class="op">%</span> <span class="bu">len</span>(issueVar))</span>
<span id="cb64-67"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-67" aria-hidden="true" tabindex="-1"></a>    issueNew <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>.join(issueVar)</span>
<span id="cb64-68"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-68" aria-hidden="true" tabindex="-1"></a>    header <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>.join([<span class="st">&quot;id&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;header&quot;</span>, <span class="st">&quot;text&quot;</span>])</span>
<span id="cb64-69"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-69" aria-hidden="true" tabindex="-1"></a>    final <span class="op">=</span> header <span class="op">+</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> issueNew</span>
<span id="cb64-70"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-71"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Now, we prepare text data for TM (into a separate column)</span></span>
<span id="cb64-72"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-72" aria-hidden="true" tabindex="-1"></a>    entitiesFinalStringIO <span class="op">=</span> io.StringIO(final)</span>
<span id="cb64-73"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-73" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(entitiesFinalStringIO, sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb64-74"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-75"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-75" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> df</span>
<span id="cb64-76"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># drop=True -- use it to avoid creating a new column with the old index values</span></span>
<span id="cb64-77"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-77" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb64-78"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-79"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column with all dates of each month changed to 1 (we can use that to aggregate our data into months)</span></span>
<span id="cb64-80"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-80" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;month&quot;</span>] <span class="op">=</span> [re.sub(<span class="st">&quot;-\d\d$&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="bu">str</span>(i)) <span class="cf">for</span> i <span class="kw">in</span> dispatch[<span class="st">&quot;date&quot;</span>]]</span>
<span id="cb64-81"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-82"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reorder columns</span></span>
<span id="cb64-83"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-83" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch[[<span class="st">&quot;id&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;header&quot;</span>, <span class="st">&quot;text&quot;</span>]]</span>
<span id="cb64-84"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-85"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-85" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;month&quot;</span>] <span class="op">=</span> pd.to_datetime(dispatch[<span class="st">&quot;month&quot;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%Y-%m&quot;</span>)</span>
<span id="cb64-86"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-86" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;date&quot;</span>] <span class="op">=</span> pd.to_datetime(dispatch[<span class="st">&quot;date&quot;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>)</span>
<span id="cb64-87"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-88"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-88" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch[dispatch.<span class="bu">type</span> <span class="op">!=</span> <span class="st">&quot;ad-blank&quot;</span>]</span>
<span id="cb64-89"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-89" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb64-90"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-91"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-91" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textData&quot;</span>] <span class="op">=</span> dispatch[<span class="st">&quot;text&quot;</span>]</span>
<span id="cb64-92"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-92" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textData&quot;</span>] <span class="op">=</span> [re.sub(<span class="st">&quot;\W+&quot;</span>, <span class="st">&quot; &quot;</span>, <span class="bu">str</span>(i).lower()) <span class="cf">for</span> i <span class="kw">in</span> dispatch[<span class="st">&quot;textData&quot;</span>]]</span>
<span id="cb64-93"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-93" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textData&quot;</span>] <span class="op">=</span> [re.sub(<span class="st">&quot; +&quot;</span>, <span class="st">&quot; &quot;</span>, <span class="bu">str</span>(i).lower()) <span class="cf">for</span> i <span class="kw">in</span> dispatch[<span class="st">&quot;textData&quot;</span>]]</span>
<span id="cb64-94"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-95"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-95" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textDataLists&quot;</span>] <span class="op">=</span> <span class="bu">list</span>(sent_to_words(dispatch[<span class="st">&quot;textData&quot;</span>].copy()))</span>
<span id="cb64-96"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-97"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># you can expand the stop word list by adding more high frequency words</span></span>
<span id="cb64-98"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-98" aria-hidden="true" tabindex="-1"></a>    stop_words_custom <span class="op">=</span> [<span class="st">&quot;the&quot;</span>, <span class="st">&quot;of&quot;</span>, <span class="st">&quot;and&quot;</span>, <span class="st">&quot;to&quot;</span>, <span class="st">&quot;in&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;that&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;on&quot;</span>, <span class="st">&quot;was&quot;</span>, <span class="st">&quot;is&quot;</span>, <span class="st">&quot;at&quot;</span>, <span class="st">&quot;be&quot;</span>, <span class="st">&quot;by&quot;</span>, <span class="st">&quot;from&quot;</span>, <span class="st">&quot;his&quot;</span>, <span class="st">&quot;he&quot;</span>, <span class="st">&quot;it&quot;</span>, <span class="st">&quot;with&quot;</span>, <span class="st">&quot;as&quot;</span>, <span class="st">&quot;this&quot;</span>, <span class="st">&quot;will&quot;</span>, <span class="st">&quot;which&quot;</span>, <span class="st">&quot;have&quot;</span>, <span class="st">&quot;or&quot;</span>, <span class="st">&quot;are&quot;</span>, <span class="st">&quot;amp&quot;</span>,</span>
<span id="cb64-99"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-99" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;they&quot;</span>, <span class="st">&quot;their&quot;</span>, <span class="st">&quot;not&quot;</span>, <span class="st">&quot;were&quot;</span>, <span class="st">&quot;been&quot;</span>, <span class="st">&quot;has&quot;</span>, <span class="st">&quot;our&quot;</span>, <span class="st">&quot;we&quot;</span>, <span class="st">&quot;all&quot;</span>, <span class="st">&quot;but&quot;</span>, <span class="st">&quot;one&quot;</span>, <span class="st">&quot;had&quot;</span>, <span class="st">&quot;who&quot;</span>, <span class="st">&quot;an&quot;</span>, <span class="st">&quot;no&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;them&quot;</span>, <span class="st">&quot;about&quot;</span>, <span class="st">&quot;him&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;upon&quot;</span>, <span class="st">&quot;may&quot;</span>, <span class="st">&quot;there&quot;</span>, <span class="st">&quot;any&quot;</span>,</span>
<span id="cb64-100"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-100" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;some&quot;</span>, <span class="st">&quot;so&quot;</span>, <span class="st">&quot;men&quot;</span>, <span class="st">&quot;when&quot;</span>, <span class="st">&quot;if&quot;</span>, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;her&quot;</span>, <span class="st">&quot;under&quot;</span>, <span class="st">&quot;would&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;such&quot;</span>, <span class="st">&quot;made&quot;</span>, <span class="st">&quot;up&quot;</span>, <span class="st">&quot;last&quot;</span>, <span class="st">&quot;j&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;years&quot;</span>, <span class="st">&quot;other&quot;</span>, <span class="st">&quot;into&quot;</span>, <span class="st">&quot;said&quot;</span>, <span class="st">&quot;new&quot;</span>, <span class="st">&quot;very&quot;</span>, <span class="st">&quot;five&quot;</span>,</span>
<span id="cb64-101"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-101" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;after&quot;</span>, <span class="st">&quot;out&quot;</span>, <span class="st">&quot;these&quot;</span>, <span class="st">&quot;shall&quot;</span>, <span class="st">&quot;my&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;more&quot;</span>, <span class="st">&quot;its&quot;</span>, <span class="st">&quot;now&quot;</span>, <span class="st">&quot;before&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;than&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;th&quot;</span>, <span class="st">&quot;o&#39;clock&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;old&quot;</span>, <span class="st">&quot;being&quot;</span>, <span class="st">&quot;left&quot;</span>, <span class="st">&quot;can&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;only&quot;</span>, <span class="st">&quot;same&quot;</span>,</span>
<span id="cb64-102"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-102" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;act&quot;</span>, <span class="st">&quot;first&quot;</span>, <span class="st">&quot;between&quot;</span>, <span class="st">&quot;above&quot;</span>, <span class="st">&quot;she&quot;</span>, <span class="st">&quot;you&quot;</span>, <span class="st">&quot;place&quot;</span>, <span class="st">&quot;following&quot;</span>, <span class="st">&quot;do&quot;</span>, <span class="st">&quot;per&quot;</span>, <span class="st">&quot;every&quot;</span>, <span class="st">&quot;most&quot;</span>, <span class="st">&quot;near&quot;</span>, <span class="st">&quot;us&quot;</span>, <span class="st">&quot;good&quot;</span>, <span class="st">&quot;should&quot;</span>, <span class="st">&quot;having&quot;</span>, <span class="st">&quot;great&quot;</span>, <span class="st">&quot;also&quot;</span>, <span class="st">&quot;over&quot;</span>,</span>
<span id="cb64-103"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-103" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;r&quot;</span>, <span class="st">&quot;could&quot;</span>, <span class="st">&quot;twenty&quot;</span>, <span class="st">&quot;people&quot;</span>, <span class="st">&quot;those&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;without&quot;</span>, <span class="st">&quot;four&quot;</span>, <span class="st">&quot;received&quot;</span>, <span class="st">&quot;p&quot;</span>, <span class="st">&quot;then&quot;</span>, <span class="st">&quot;what&quot;</span>, <span class="st">&quot;well&quot;</span>, <span class="st">&quot;where&quot;</span>, <span class="st">&quot;must&quot;</span>, <span class="st">&quot;says&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;large&quot;</span>, <span class="st">&quot;against&quot;</span>, <span class="st">&quot;back&quot;</span>, <span class="st">&quot;through&quot;</span>,</span>
<span id="cb64-104"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-104" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;b&quot;</span>, <span class="st">&quot;off&quot;</span>, <span class="st">&quot;few&quot;</span>, <span class="st">&quot;me&quot;</span>, <span class="st">&quot;sent&quot;</span>, <span class="st">&quot;while&quot;</span>, <span class="st">&quot;make&quot;</span>, <span class="st">&quot;number&quot;</span>, <span class="st">&quot;many&quot;</span>, <span class="st">&quot;much&quot;</span>, <span class="st">&quot;give&quot;</span>, <span class="st">&quot;six&quot;</span>, <span class="st">&quot;down&quot;</span>, <span class="st">&quot;several&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;since&quot;</span>, <span class="st">&quot;little&quot;</span>, <span class="st">&quot;during&quot;</span>, <span class="st">&quot;away&quot;</span>, <span class="st">&quot;until&quot;</span>,</span>
<span id="cb64-105"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-105" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;each&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;own&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;here&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;found&quot;</span>, <span class="st">&quot;reported&quot;</span>, <span class="st">&quot;right&quot;</span>, <span class="st">&quot;given&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;your&quot;</span>, <span class="st">&quot;way&quot;</span>, <span class="st">&quot;side&quot;</span>, <span class="st">&quot;did&quot;</span>, <span class="st">&quot;part&quot;</span>, <span class="st">&quot;long&quot;</span>, <span class="st">&quot;next&quot;</span>, <span class="st">&quot;fifty&quot;</span>,</span>
<span id="cb64-106"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-106" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;another&quot;</span>, <span class="st">&quot;1st&quot;</span>, <span class="st">&quot;whole&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;still&quot;</span>, <span class="st">&quot;among&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;within&quot;</span>, <span class="st">&quot;get&quot;</span>, <span class="st">&quot;named&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;himself&quot;</span>, <span class="st">&quot;ten&quot;</span>, <span class="st">&quot;both&quot;</span>, <span class="st">&quot;nothing&quot;</span>, <span class="st">&quot;again&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;thirty&quot;</span>, <span class="st">&quot;eight&quot;</span>, <span class="st">&quot;took&quot;</span>,</span>
<span id="cb64-107"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-107" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;never&quot;</span>, <span class="st">&quot;came&quot;</span>, <span class="st">&quot;called&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;passed&quot;</span>, <span class="st">&quot;just&quot;</span>, <span class="st">&quot;brought&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;further&quot;</span>, <span class="st">&quot;yet&quot;</span>, <span class="st">&quot;half&quot;</span>, <span class="st">&quot;far&quot;</span>, <span class="st">&quot;held&quot;</span>, <span class="st">&quot;soon&quot;</span>, <span class="st">&quot;main&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;however&quot;</span>, <span class="st">&quot;say&quot;</span>,</span>
<span id="cb64-108"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-108" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;heavy&quot;</span>, <span class="st">&quot;thus&quot;</span>, <span class="st">&quot;hereby&quot;</span>, <span class="st">&quot;even&quot;</span>, <span class="st">&quot;ran&quot;</span>, <span class="st">&quot;come&quot;</span>, <span class="st">&quot;whom&quot;</span>, <span class="st">&quot;like&quot;</span>, <span class="st">&quot;cannot&quot;</span>, <span class="st">&quot;head&quot;</span>, <span class="st">&quot;ever&quot;</span>, <span class="st">&quot;themselves&quot;</span>, <span class="st">&quot;put&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;cause&quot;</span>, <span class="st">&quot;known&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;go&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;once&quot;</span>, <span class="st">&quot;therefore&quot;</span>,</span>
<span id="cb64-109"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-109" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;thursday&quot;</span>, <span class="st">&quot;full&quot;</span>, <span class="st">&quot;apply&quot;</span>, <span class="st">&quot;see&quot;</span>, <span class="st">&quot;though&quot;</span>, <span class="st">&quot;seven&quot;</span>, <span class="st">&quot;tuesday&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;done&quot;</span>, <span class="st">&quot;whose&quot;</span>, <span class="st">&quot;let&quot;</span>, <span class="st">&quot;how&quot;</span>, <span class="st">&quot;making&quot;</span>, <span class="st">&quot;immediately&quot;</span>, <span class="st">&quot;forty&quot;</span>, <span class="st">&quot;early&quot;</span>, <span class="st">&quot;wednesday&quot;</span>,</span>
<span id="cb64-110"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-110" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;either&quot;</span>, <span class="st">&quot;too&quot;</span>, <span class="st">&quot;amount&quot;</span>, <span class="st">&quot;fact&quot;</span>, <span class="st">&quot;heard&quot;</span>, <span class="st">&quot;receive&quot;</span>, <span class="st">&quot;short&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;100&quot;</span>,</span>
<span id="cb64-111"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-111" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;know&quot;</span>, <span class="st">&quot;might&quot;</span>, <span class="st">&quot;except&quot;</span>, <span class="st">&quot;supposed&quot;</span>, <span class="st">&quot;others&quot;</span>, <span class="st">&quot;doubt&quot;</span>, <span class="st">&quot;set&quot;</span>, <span class="st">&quot;works&quot;</span>]</span>
<span id="cb64-112"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-113"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># TEXT CLEANING</span></span>
<span id="cb64-114"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-114" aria-hidden="true" tabindex="-1"></a>    dispatch[<span class="st">&quot;textDataLists&quot;</span>] <span class="op">=</span> remove_words(dispatch[<span class="st">&quot;textDataLists&quot;</span>], stop_words_custom)</span>
<span id="cb64-115"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-115" aria-hidden="true" tabindex="-1"></a>    dispatch <span class="op">=</span> dispatch[[<span class="st">&quot;id&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;header&quot;</span>, <span class="st">&quot;text&quot;</span>, <span class="st">&quot;textDataLists&quot;</span>]]</span>
<span id="cb64-116"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-116" aria-hidden="true" tabindex="-1"></a>    dispatch.to_csv(target <span class="op">+</span> <span class="st">&quot;Dispatch_</span><span class="sc">%s</span><span class="st">_tmReady.tsv&quot;</span> <span class="op">%</span> <span class="bu">str</span>(YEAR), sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb64-117"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-118"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-119"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-119" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1860</span>)</span>
<span id="cb64-120"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-120" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1861</span>)</span>
<span id="cb64-121"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-121" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1862</span>)</span>
<span id="cb64-122"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-122" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1863</span>)</span>
<span id="cb64-123"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-123" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1864</span>)</span>
<span id="cb64-124"><a href="lesson-12-topic-modeling-tf-idf-automatic-text-analysis.html#cb64-124" aria-hidden="true" tabindex="-1"></a>convertDispatchToCSV(source, target, <span class="dv">1865</span>)</span></code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-RamsayReading2011" class="csl-entry">
Ramsay, Stephen. 2011. <em>Reading Machines: Toward an Algorithmic Criticism</em>. Topics in the Digital Humanities. <span>Urbana, <span>IL</span></span>: <span>University of Illinois Press</span>.
</div>
<div id="ref-SPARCKJONESStatistical1972" class="csl-entry">
Spärck Jones, Karen. 1972. <span>“A Statistical Interpretation of Term Specificity and Its Application in Retrieval.”</span> <em>Journal of Documentation</em> 28 (1): 11–21. <a href="https://doi.org/10.1108/eb026526">https://doi.org/10.1108/eb026526</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lesson-11-mapping-data-using-tagged-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lesson-13-social-network-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "github"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/maximromanov/dh_in_mes/edit/main/02-Lesson12.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/maximromanov/dh_in_mes/blob/main/02-Lesson12.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

</body>

</html>
