# Lesson 11: Mapping Data (using tagged data)

## Preparing and Modeling Geospatial Data

In a similar manner we can also graph geographical data --- in combination with the temporary dimension. For this, however, we need to think through what kind of insight we can possibly get from geospatial data and how it should be prepared for mapping.

Let's start with a simple task: we will map the geospatial data from one of the previous lessons: [settlements from the al-Thurayya Gazetteer](./files/settlements.csv). This 

```{r engine='python', highlight=TRUE, eval=FALSE}


```

We can get the following maps:

...

Now, let's get back to our Dispatch data. We have placenames tagged --- and we already have the data ready for processing. We can focus on a specific period of time (by filtering our data, including only dates that we are interested in). Then we need to calculate frequencies of mentions of placenames --- we can use these values to size dots on the final map. Unfortunately, a very important element is missing --- as you recall, our data does not have any coordinates. Luckily, we have unique identifiers from the Getty Thesaurus of Geographical Names. What we can do is to extract coordinates from the Thesaurus and connect them to corresponding placenames in our data.

- Getty Thesaurus is available for download here: <http://tgndownloads.getty.edu/> and here: <http://vocab.getty.edu/dataset/tgn/>
- You can download `explicit.zip` from <http://vocab.getty.edu/dataset/tgn/>
- There is a file `TGNOut_Coordinates.nt` with coordinates. You will need to write a script to extract coordinates from this file in order to use them. I suggest you convert this file (the format is `N-triples`)

### `N-triples`

What are triples? This is one of the most robust formats that can describe any kind of data. The main idea is that every triple is expressed through the structure `subject-predicate-object`. There are multiple formats for expressing triples (for example, RDF, N-Triples, etc.) ([*more details...*](https://en.wikipedia.org/wiki/Semantic_triple)).

Let's take a look at the following example from `TGNOut_Coordinates.nt`. There are three triples (`N-triples`) which together describe a specific object (which in our data would look like `tgn,1000007`). Each triple is stored on a separate line, ending with a period ("."). Elements of each triple are separated with spaces. Each triple has the same structure---`subject-predicate-object`---and can be read as follows.

- Triple 1: entity `tgn,1000007` has (expressed in a particular manner) geographical coordinates;
- Triple 2: entity `tgn,1000007` has decimal latitude `-83.843`;
- Triple 3: entity `tgn,1000007` has decimal longitude `65.725`;

```
<http://vocab.getty.edu/tgn/1000007-geometry> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://schema.org/GeoCoordinates> .
<http://vocab.getty.edu/tgn/1000007-geometry> <http://schema.org/latitude> "-83.843"^^<http://www.w3.org/2001/XMLSchema#decimal> .
<http://vocab.getty.edu/tgn/1000007-geometry> <http://schema.org/longitude> "65.725"^^<http://www.w3.org/2001/XMLSchema#decimal> .
```

You should have no problems writing a script that converts this data into a CSV with the structure: `ID`, `lon`, and `lat`. (Technically, you can also store these triples in a CSV/TSV format, but that would require additional conversion later.)

If you are not up to this challenge, you can use the CSV file tat I have already prepared, to make your life a bit easier: [TGNOut_Coordinates.csv.zip](./files/TGNOut_Coordinates.csv.zip)



## Homework{#HWL11}

- Finish the assigned task;
- Annotate your script (i.e., add comment to every line of code describing what is happenning there);

**Submitting homework:**

* Homework assignment must be submitted by the beginning of the next class;
* Now, that you know how to use GitHub, you will be submitting your homework pushing it to github:
  * Create a relevant subfolder in your repository and place your HW files there; push them to your GitHub account;
	* Email me the link to your repository with a short message (Something like: *I have completed homework for Lesson 3, which is uploaded to my repository ... in subfolder `L03`*)


## Solution{#SolutionL11}

Below is the solution to the homework...

```{r engine='python', highlight=TRUE, eval=FALSE}


```
